#!/bin/sh
JSON_STRING='window.configs = { \
  "VITE_LOGIN_OIDC":"'"${VITE_LOGIN_OIDC}"'", \
  "VITE_LOGIN_SIMPLE":"'"${VITE_LOGIN_SIMPLE}"'", \
  "VITE_OIDC_AUTHORITY":"'"${VITE_OIDC_AUTHORITY}"'", \
  "VITE_OIDC_CLIENT_ID":"'"${VITE_OIDC_CLIENT_ID}"'", \
  "VITE_OIDC_REDIRECT_URI":"'"${VITE_OIDC_REDIRECT_URI}"'", \
  "VITE_OIDC_POST_LOGOUT_REDIRECT_URI":"'"${VITE_OIDC_POST_LOGOUT_REDIRECT_URI}"'", \
  "VITE_OIDC_RESPONSE_TYPE":"'"${VITE_OIDC_RESPONSE_TYPE}"'", \
  "VITE_OIDC_SCOPE":"'"${VITE_OIDC_SCOPE}"'", \
  "VITE_ADDRESS_DEPRECATION_WARNING":"'"${VITE_ADDRESS_DEPRECATION_WARNING}"'", \
  "VITE_DEV_MODE":"'"${VITE_DEV_MODE}"'", \
  "VITE_URL_PREFIX":"'"${VITE_URL_PREFIX}"'", \
  "VITE_SERVER_ADDRESS":"'"${VITE_SERVER_ADDRESS}"'", \
  "VITE_CURRENT_COMMIT_VERSION":"'"${VITE_CURRENT_COMMIT_VERSION}"'", \
  "VITE_ALLOWED_PACKAGE_DESCRIPTION_TAGS":"'"${VITE_ALLOWED_PACKAGE_DESCRIPTION_TAGS}"'" \
}'
sed -i "s@// CONFIGURATIONS_PLACEHOLDER@${JSON_STRING}@" /usr/share/nginx/html/index.html
exec "$@"
